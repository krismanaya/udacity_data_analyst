---
title: "Bernie Sanders & Donald J. Trump Contributions."
author: "Kris Anaya"
date: "5/22/2017"
output: html_document
---

```{r echo=FALSE, message=FALSE, warning=FALSE, load_packages}
#install.packages("stringr")
#install.packages(c("maps","mapdata"))
#install.packages("ggmap")

library(mapdata)
library(maps)
library(ggmap)
library(ggplot2)
library(dplyr)
library(GGally)
library(scales)
library(memisc)
library(gridExtra)
library(grid)
library(RColorBrewer)
library('bitops')
library('RCurl')


setwd("/Users/Anaya/repos/udacity_data_analyst/project_4/src") # set my directory. 
```


```{r echo=FALSE, message=FALSE, warning=FALSE, Load_the_Data}

############################################# Bernie Dataset ######################################################

bsdf <- read.csv(file = "P60007168-CA.csv", sep = ",", header = FALSE)

colnames(bsdf) <- c("cmte_id", "cand_it", "canidate", "name",
                    "city", "state", "zip", 
                    "employer", "occupation",
                    "amount", "date",
                    "receipt", "memo",
                    "memo_text", "form_tp", "file_number",
                    "tan_id", "election_tp") # rename columns 

bsdf  = bsdf[-1,] #drop first row in dataset

myvars <- c("name","canidate","city","state","zip","employer","occupation","amount","date","receipt") #create data columns

bsdf <- bsdf[myvars] #pick columns I need. 

bsdf$amount <- as.numeric(as.character(bsdf$amount)) #change amount to numeric
bsdf$zip <- as.numeric(as.character(bsdf$zip)) #change zip to numeric#change date
bsdf$date <- strptime(bsdf$date, "%d-%b-%y")
bsdf$date <- as.POSIXlt(bsdf$date)


############################################# Trump Dataset ######################################################

dtdf <- read.csv("P80001571-CA.csv", sep = ",", header = FALSE)

colnames(dtdf) <- c("cmte_id", "cand_id", "canidate", "name","city", "state", "zip", "employer", "occupation", "amount", "date","receipt", "memo","memo_text", "form_tp", "file_number","tran_id", "election_tp") # rename columns 


dtdf = dtdf[-1,] #drop first row
myvars <- c("name","canidate","city","state","zip","employer","occupation","amount","date","receipt") #create data columns
dtdf <- dtdf[myvars] #choose columns i'm interested in.

dtdf$amount <- as.numeric(as.character(dtdf$amount)) #change amount to numeric
dtdf$zip <- as.numeric(as.character(dtdf$zip)) #change zip to numeric#change date
dtdf$date <- strptime(dtdf$date, "%d-%b-%y") #fix date
dtdf$date <- as.POSIXlt(dtdf$date) #fix date


############################################# Map Datasets ##########################################################
counties <- map_data("county")
ca_county <-subset(counties, region == "california")

#create a unique datafram using google long and lat queries. 
#cities <- as.data.frame(unique(bsdf$city))
#names(cities)[names(cities) == 'unique(bsdf$city)'] <- 'city'
#cities$city_state <- paste(as.character(cities$city), "CA", sep=", ") 
#cities.new <- cbind(geocode(as.character(cities$city_state)), cities)
#write.csv(cities.new, file = "California_geoLocation_new.csv",row.names=FALSE)

## filling in columns with matching IDs from two dataframes in R
# Source: http://stackoverflow.com/questions/25539326/filling-in-columns-with-matching-ids-from-two-dataframes-in-r
geoloc <- read.csv('California_geoLocation_new.csv', row.names=NULL) #load dataset

nm <- c("lon", "lat") #add lat long 
bsdf[nm] <- lapply(nm, function(x) geoloc[[x]][match(as.character(bsdf$city), as.character(geoloc$city))]) #create loc dataset for bernie
dtdf[nm] <- lapply(nm, function(x) geoloc[[x]][match(as.character(dtdf$city), as.character(geoloc$city))]) #apply it to trump dataset 



############################################## Sample Datasets ###########################################################

#Bernie sample
set.seed(20000)
sample_bernie <- bsdf[sample(1:length(bsdf$amount), 3000), ] #sample dataset for bernie

#subset dataframes 

largest_cities_bsdf <- subset(bsdf, city == c("SAN FRANCISCO", "SAN JOSE", "LOS ANGELES","SACRAMENTO","SAN DIEGO", "OAKLAND",
                                              "BERKELEY")) #sanders contributions in bigger cities

refund_bsdf <- subset(bsdf, receipt == "Refund" & city ==  c("BAKERSFIELD", "SAN JOSE", "LOS ANGELES","SACRAMENTO","SAN DIEGO", "HUNTINGTON BEACH",
                                                            "OAKLAND", "BERKELEY", "SAN FRANCISCO"))  # largest cities who obtained a refund.



largest_amount_bsdf <- subset(largest_cities_bsdf, amount > 0) #no refunds in dataset


#Trump Sample
set.seed(20000)
sample_trump <- bsdf[sample(1:length(dtdf$amount), 3000), ] #sample dataset for trump

largest_cities_dtdf <- subset(dtdf, city == c("BAKERSFIELD", "SAN JOSE", "LOS ANGELES","SACRAMENTO","SAN DIEGO", "HUNTINGTON BEACH")) #sanders contributions in bigger cities

refund_dtdf <- subset(dtdf, receipt == "Refund" & city ==  c("BAKERSFIELD", "SAN JOSE", "LOS ANGELES","SACRAMENTO","SAN DIEGO", "HUNTINGTON BEACH",
                                                         "OAKLAND", "BERKELEY", "SAN FRANCISCO"))   # largest cities who obtained a refund.


largest_amount_dtdf <- subset(largest_cities_dtdf, amount > 0) #no refunds in dataset. 



############################################## Merge Dataset ###########################################################
merge_bs_dt_df <- merge(bsdf, dtdf, all = TRUE) # merge both datasets

largest_cities_merge <- subset(merge_bs_dt_df, city == c("BAKERSFIELD", "SAN JOSE", "LOS ANGELES","SACRAMENTO","SAN DIEGO", "HUNTINGTON BEACH",
                                                         "OAKLAND", "BERKELEY", "SAN FRANCISCO")) # largest cities for both canidates

largest_amount_merge <- subset(largest_cities_merge, amount > 0) # no refunds in ammount



############################################ Sample Merge Dataset ######################################################
#create only Bernie and Trump: 
merge_bs_dt_df_subset <- merge_bs_dt_df[merge_bs_dt_df$canidate %in% c("Trump, Donald J.","Sanders, Bernard"),]

#create some variables that I want for correlation. 
merge_bs_dt_df_subset <- subset(merge_bs_dt_df, select = c(canidate, amount))

#drop unused levels
merge_bs_dt_df_subset <- droplevels(merge_bs_dt_df_subset)

```

This report explores a dataset containing canidates and attributes for approximately 490,000 contributions. 

# Univariate Plot Section 

```{r echo=FALSE, message=FALSE, warning=FALSE, univariate_plot}



################################################# Amount ###################################################

str(merge_bs_dt_df) #observe merge data

summary(merge_bs_dt_df) #view summary of data

# create histogram of count vs amount facet_wrap by canidates. 
qplot(x = amount, data = merge_bs_dt_df_subset, color = I("black"), fill = I("firebrick4")) + 
  labs(title = "Bernie v Trump Contributions",
       subtitle = "Count vs. Amount", 
       caption = ".gov") + 
  facet_wrap(~canidate) +
  scale_x_continuous(limits = c(0,1000), breaks = seq(0,1000,100)) + 
  scale_y_continuous(limits = c(0,10000), breaks = seq(0,10000,1000)) 

#take the sqrt and then scale it by base 10.
qplot(x = amount, data = merge_bs_dt_df_subset, color = I("black"), fill = I("firebrick4")) + 
  labs(title = "Bernie v Trump Contributions Base 10",
       subtitle = "Count vs. Amount", 
       caption = ".gov") + 
  facet_wrap(~canidate) +
  scale_x_continuous(limits = c(0,1000), breaks = seq(0,2000,100)) +
  coord_trans(y ="sqrt") + 
  scale_y_log10() 
```

Transformed both long tail-esque data to better understand the distribution of amount by each canidate. The transformed amount appears realtively similary with both canidates. Although, 
Sanders has a bit more contributiosn that are less then the fifty-dollar range peaking above 10 thousand, while Trump appears to have a larger count of amount around the nine-hundred dollar range. Let's investigate 
some other variables like cities, Occupation and name.  

```{r echo=FALSE, message=FALSE, warning=FALSE, univariate_plot_partII}


################################################## Cities ################################################
city_text <- element_text(size = 3) #change x.axis text 
# creat a subset of merge_bs_dt_df with largest mentropolitan cities and plot them using qplot function. 
choose_city_df_sample <- subset(merge_bs_dt_df, merge_bs_dt_df$city %in% c("BAKERSFIELD", "SAN JOSE", "SAN FRANCISCO", "BERKELEY", "LOS ANGELES",
                                                                           "SACRAMENTO","SAN DIEGO", "OAKLAND", "HUNTINGTON BEACH"))
qplot(x = city, data = choose_city_df_sample, color = I("black"), fill = I("paleturquoise1")) + 
  labs(title = "Bernie v Trump Contributions",
       subtitle = "Count vs. City", 
       caption = ".gov") + 
  theme(axis.text.x = city_text) + 
  facet_wrap(~canidate) 

###################################################### Occupation #############################################
occupation_text <- element_text(size = 4) #change x.axis text
# create a subset of merge_bs_dt_df with largest occupations in data set and plot. 
choose_occupation_df_sample <- subset(merge_bs_dt_df, merge_bs_dt_df$occupation %in% c("NOT EMPLOYED", "RETIRED", "INFORMATION REQUESTED", 
                                                                                       "TEACHER", "ENGINEER"))

qplot(x = occupation, data = choose_occupation_df_sample, color = I("black"), fill = I("pink3")) + 
  labs(title = "Bernie v Trump Contributions", 
       subtitle = "Count vs. Occupation", 
       caption = ".gov") + 
  theme(axis.text.x = occupation_text) + 
  facet_wrap(~canidate)



############################################# Name #############################################
name_text <- element_text(size = 5) #change x.axis text
#create a subset of merge_bs_dt_df with most contributed by name and plot.  
choose_name_df_sample <- subset(merge_bs_dt_df, merge_bs_dt_df$name %in% c("WEIL, MONIQUE", "MCLENNAN, MARLYN", "AUSLENDER, LEONARD", "ISERI, MARTIN", 
                                                                            "SPEAR, JOSEPH", "DAVIDSON, LISA", "(Other)"))

qplot(x = name, data = choose_name_df_sample, color = I("black"), fill = I("orchid2")) + 
  labs(title = "Bernie V Trump Contributions", 
       subtitle = "Count vs. Name", 
       caption = ".gov") + 
  theme(axis.text.x = occupation_text) + 
  facet_wrap(~canidate)
```

Most Major cities contributed to Bernie's campaign, with pretty smiliary contributions in Bakersfield and Hunnigton Beach. A majority of occuptations that contributed to Bernie's campaign are "Not Employed", 
while more in Trump's contributions are "RETIRED". Finally, that contributed more then two hundred contributions seem to support the Bernied campaign rather than Trump's. It looks like no large multiple contributions 
were made with the Trump campaign in California. 


```{r echo=FALSE, message=FALSE, warning=FALSE, not_employed}

#subset data set with people unemployed
not_employed_df <- subset(merge_bs_dt_df, occupation == "NOT EMPLOYED")

#create plot of amount by unemployment
qplot(x = amount, data = not_employed_df, color = I("black"), fill=  I('#F79420')) +
  labs(title = "Bernie V Trump Contributions", 
       subtitle = "Count vs. Name", 
       caption = ".gov") +
  scale_x_continuous(limits = c(0,500)) + 
  scale_y_continuous(limits = c(0,1000)) + 
  scale_y_log10() + 
  facet_wrap(~canidate)

#create a summary of amount by state
by(not_employed_df$amount, not_employed_df$state, summary)
```
If we consider the unemployment between two canidates it would seem that mister Sanders has the largest. Most poeple who are unemployed 
fall into the zero to hundred dollar amount while we see a converging pattern as the amount increases. Within the summary we see that 
the median is exactly twenty-seven dollars the same amount which Mr. Sanders proclaimed in his campaign speeches. 


```{r echo=FALSE, message=FALSE, warning=FALSE, largest_contributors}

#subset datafram based on name
largest_cont_df <- subset(merge_bs_dt_df, merge_bs_dt_df$name %in% c("WEIL, MONIQUE", "MCLENNAN, MARLYN", "AUSLENDER, LEONARD", "ISERI, MARTIN", 
                                                                            "SPEAR, JOSEPH", "DAVIDSON, LISA")) 

#create regular qplot based on amount
qplot(x = amount, data = largest_cont_df) + 
  labs(title = "Largest Contributors")


#create limits of plot based on amount 
qplot(x = amount, data = largest_cont_df) + 
  labs(title = "Largest Contributors") + 
  scale_x_continuous(limits = c(0,500)) + 
  scale_y_continuous(limits = c(0,300))


#remove outliers
qplot(x = amount, data = largest_cont_df) + 
  labs(title = "Largest Contributors") + 
  scale_x_continuous(limits = c(0,150)) + 
  scale_y_continuous(limits = c(0,290))


#skew tail then take a logtransform 
qplot(x = amount, data = largest_cont_df) + 
  labs(title = "Largest Contributors") + 
  scale_x_continuous(limits = c(0,150)) + 
  scale_y_continuous(limits = c(0,290)) + 
  scale_y_log10()
  

#color plot 
qplot(x = amount, data = largest_cont_df, color = I("black"), fill = I('#099DD9')) + 
  labs(title = "Bernie V Trump Contributions", 
       subtitle = "Largest Contributors by Amount", 
       caption = ".gov") +
  scale_x_continuous(limits = c(0,150)) + 
  scale_y_continuous(limits = c(0,290)) + 
  scale_y_log10() + 
  facet_wrap(~name) 

```

I wanted to do a step by step approach of the dataset of the names who contributed the most. All of these names contributed to the Bernie Sanders campaign as was visualized above. When we zoom in and look closer at the data 
and seperate the names in each column while taking a log transformation of the slightly skewed chart we can get a very clear visualization of how the contributors spread out there payments. I didn't want to get into the refund payments just yet in the data set because it requires multiple variables to investigate further, but as you can see from the chart above most of the contributions to the Sanders Campaign were paid around a wide variety of ranges.


```{r echo=FALSE, message=FALSE, warning=FALSE}
str(merge_bs_dt_df)
summary(merge_bs_dt_df)
#change text size
occupation_text <- element_text(size = 5) #change x.axis text

#create a plot of occupation from largest contributors
qplot(x = occupation, data = largest_cont_df, color = I("black"), fill = I("#099DD9")) + 
  labs(title = "Bernie V Trump Contributions", 
       subtitle = "Largest Contributors by Occupation", 
       caption = ".gov") +
  theme(axis.text.x = occupation_text) + 
  facet_wrap(~name)
#largest amounts across the board from the names dataframe
summary(largest_cont_df$amount)

```

In this second graph concerning occupation you can see that people had standard employments such as Teacher, Not Employed, Retired, Clerk and Photographer. 
What striked me odd in this barplot was some people changed there occupation with donations for example MCLENNAN, MARLYN was listed as RETIRED and NOT EMPLOYED. 


# Univariate Analysis 

## What is the structure of your dataset? 

This report explores a dataset containing canidates and attributes for approximately 490,000 contributions with 12 features
(name,canidate,city,state,zip,employer,occupation,amount,date,receipt,lon,lat). The variables name, canidate, city state, employer, occupation are factors. 

Other observations: 
* cities with most contributors are leaning liberal
* largest contributor occupation is not employed 
* largest count of contributions are Bernie supporters
* largest refund is more then alloted 10k 
* biggest contributions is the upperbound of 10k


## What is/are the main feature(s) of interest in your dataset? 

the main features of the dataset are amount, city and occupation. I'd like to determine which features 
are voting for each respected canidates the most and what is their median or max contributions for each canidate 
as well as top locations. 


## Did you create any new variables from existing variables in the dataset? 
They only feature I truly changed within the data set is the datetime which I re translated it 
to a more formal method so I may view it during my bivariate plot section. Other then that most variables were just re 
written to express a more readable form. 


## Of the features you investigated, were there any unusual distributions? Did you perform 
any operations on the data to tidy, adjust, or change the form of the data? If so, why did you do this? 

I log-transformed the right skewed of the amount and count of the contributions in the canidate. While the price still has a similar skewedness I wanted to to investigate a deeper understand of the dataset for which it gave me a clear picture and understand of how the data set functioned. Primarly, we can see within the amount that the Sander's group tends to contribute more in the below hundred dollar range while Trump's group tends to follow a higher contribution pattern. Most of the distrobutions had okay patterns. They only real unusual visualization I saw was employment being change by person in the largest contributions by occupation graph. 


# Bivariate Plots Sections

```{r echo=FALSE, message=FALSE, warning=FALSE}
# select some variables that you want to use in your comparison
merge_correlation_comparison <- subset(merge_bs_dt_df, selec = c(date, amount, canidate))

#drop unused levels
merge_correlation_comparison <- droplevels(merge_correlation_comparison)

#brief overview of data
summary(merge_correlation_comparison)

#cross validation matrix 
set.seed(20022012) # set the seed 
merge_samp <- merge_correlation_comparison[sample(1:length(merge_correlation_comparison$amount), 10000), ]

#create plot of date, amount and canidate. 
ggpairs(merge_samp, 
        lower = list(continuous = wrap("points", shape = I("."))), 
        upper = list(continuous = wrap("box", outlier.shape = I("."))), 
        title = "Matrix plot of Date, Amount from Canidates.")


```
I created a subset of the data with amount, canidate and date. The problem I have in this datset is you don't have real numerical analysis
but primarly location and amount contributions. But, you still can see interesting results in this matrix plot for instance, the canidates 
by date you see some noramility in one of the canidates. Secondly, if you look at the date time between Jan and July you see a large growth in contributions, let's investigate this further.

```{r echo=FALSE, message=FALSE, warning = FALSE, bivariante_plots}
#histogram, first set theme

#set text size
text_size <- element_text(size = 5)

#create histogram of canidates by date
ggplot(merge_samp, aes(x = date, y = canidate, fill = canidate)) + 
  geom_histogram(stat="identity", position = position_nudge()) + 
 theme(axis.text.x = text_size) + 
  scale_fill_manual(values=c("deepskyblue3", "firebrick3")) +   
  xlab("Date") + ylab("Canidate") + # Set axis labels
  ggtitle("Contributions by Date") +     # Set title
  theme_bw()


```
As the date moves into the election you see that donald Trump contributions are growning and Bernies are decreasing. 
This is due to the fact that Donald Trump went on to become the Repulican party canidate and Bernie Sanders had to drop out of the 
race. Let's look at this in a more normal distrubtion. 

```{r echo=FALSE, message=FALSE, warning = FALSE, bivariante_plotsII}

#create histogram of canidates by date but facet_wrap it in one column
ggplot(merge_samp, aes(x = date, y = canidate, fill = canidate)) + 
  geom_histogram(stat="identity") + 
  theme(axis.text.x = text_size,
        axis.title.y=element_blank(),
        axis.text.y=element_blank(),
        axis.ticks.y=element_blank()) + 
  scale_fill_manual(values=c("deepskyblue3", "firebrick3")) +   
  ggtitle("Contributions by Date") +     # Set title
   facet_wrap(~canidate, ncol = 1) 


#create a by function of summary by date and canidate. 
by(merge_samp$date, merge_samp$canidate, summary)
```

Clearly we see that Sanders' campaign is increasing as the months go on peacking around the third or forth month of 2016. We don't see 
large contributions in Donald Trump until the June mark. This could be due to teh fact that he was nominated aroudn this time or it's possible that California was still not interested in Donald Trump being the Republican canidate and still was hoping for a more moderate conservative like Jeb Bush or John Kasich. These plots do paint a very well detailed portrait of the canidates time running for president. 

```{r echo=FALSE, message=FALSE, warning=FALSE, line_graphs}


#line graph 
ggplot(data = choose_city_df_sample, aes(date, amount, color = canidate)) + 
  geom_line() + 
  labs(titie = "Line Graph for Sanders V Trump", 
       subtitle = "Amount vs Date", 
       caption = "source: .gov") + 
  facet_wrap(~canidate, ncol = 1) + 
  scale_color_manual(values=c("deepskyblue3", "firebrick3")) 


```

As you may view from above the trend of the line graph by date between Sanders and Trump. Some observations to view are Sander's data set is not a consistent as Trump's. Meaning, his data set tends to peak and fall between 
high donations and refunds, while Trump's data set seems to look more uniform in nature. Could this have something to do with anixety in the election cylce? One observation to be noted is the negative amount in the y axis. Let's dive into this a bit closer.

```{r echo=FALSE, message=FALSE, warning=FALSE, bar_graphs}
#hisogram of refunds of bernie and trump
theme_set(theme_bw())
p1 <- ggplot(refund_bsdf, aes(x=city, y=amount)) + 
      geom_bar(stat = "identity", width=.5, fill="deepskyblue3") + 
      labs(title="Ordered Bar Chart of Refunds", 
       subtitle="Bernie Sanders", 
       caption="source: gov") + 
  theme(axis.text.x = element_text(angle=65, vjust=0.6)) 

p2 <- ggplot(refund_dtdf, aes(x = city, y= amount)) + 
  geom_bar(stat = "identity", width = .2, fill = "firebrick3") + 
  labs(title="Ordered Bar Chart of Refunds", 
       subtitle="Donald Trump", 
       caption= "source:. gov") + 
  theme(axis.text.x = element_text(angle=65, vjust=0.6)) 

#arrange the plots of historgrams of refunds
grid.arrange(p1,p2,ncol = 2)

#hisogram for both canidates.
theme_set(theme_bw())
ggplot(largest_amount_merge, aes(x=city, y=amount, color = canidate)) + 
  geom_bar(stat="identity", width=.5, fill = "lavenderblush2") + 
  labs(title="Ordered Bar Chart", 
       subtitle="Amount vs. City", 
       caption="source: gov") + 
  theme(axis.text.x = element_text(angle=65, vjust=0.6)) + 
  facet_wrap(~canidate) + 
  scale_color_manual(values=c("deepskyblue3", "firebrick3")) 


```

as you can see above most of the refund that were return were by Bernie Sanders campaigne. While some refunds were made by Donald Trump it seems that Bernie Sanders had the most. However, one thing to keep in mind is 
that Bernie's dataset is larger so it could account for just more datapoints in the plot. if we look at amounts we can see that Bernie sanders has more contributions in the postive direction as well. Let's look at these in more depth statistically. 


```{r echo=FALSE, message=FALSE, warning=FALSE, box_plot}
theme_set(theme_bw())
p1 <- ggplot(refund_bsdf, aes(x=city, y=amount)) + 
      geom_boxplot(width=.5, fill="deepskyblue3") + 
      labs(title="Ordered boxplot of Refunds", 
       subtitle="Bernie Sanders", 
       caption="source: gov") + 
  theme(axis.text.x = element_text(angle=65, vjust=0.6)) + 
  scale_y_continuous(limits = c(-2000, 0))

#drop levels. 
bernie_city <- droplevels(refund_bsdf)
#summary of Bernie refund by city
by(bernie_city$amount, bernie_city$city, summary)

p2 <- ggplot(refund_dtdf, aes(x = city, y= amount)) + 
  geom_boxplot( width = .2, fill = "firebrick3") + 
  labs(title="Ordered boxplot of Refunds", 
       subtitle="Donald Trump", 
       caption= "source:. gov") + 
  theme(axis.text.x = element_text(angle=65, vjust=0.6)) + 
  scale_y_continuous(limits = c(-4000, -2000))


#drop levels.
trump_city <- droplevels(refund_dtdf)
#Sumary of Trump refunds by city
by(trump_city$amount, trump_city$city, summary)

#arrange the boxplots of refunds
grid.arrange(p1,p2,ncol = 2)


#drop levels 
largest_amount_bernie_trump <- droplevels(largest_amount_merge)

#summary of Trump, Bernie refunds by city
by(largest_amount_bernie_trump$amount, largest_amount_bernie_trump$city, summary)

# summary of box plot by canidate in major cities.
#box plot of payments by canidate. 
ggplot(aes(x = canidate, y = amount, fill = canidate), data = largest_amount_bernie_trump) +
  geom_boxplot() + labs(title = "Ordered Box Plot", 
                        subtitle = "Amount vs. City", 
                        caption = "source: .gov") + 
  scale_y_continuous(limits = c(0,200), breaks = seq(0,200,10)) + 
  scale_fill_manual(values=c("deepskyblue3", "firebrick3")) 

#correlation teset
#no real correlation between zip code and the amount people spend.
cor.test(merge_bs_dt_df$zip,merge_bs_dt_df$amount, method = "pearson")

```




We can now see that most of the the regunds fall into a median point for Sanders less then negative five hundred dollars. While, the Trump team seems to have small strips. If we view the postive amount, meaning the contributions, 
we see that by city the median rate is in twenty-seven mark for Bernie Sanders (which was a campaign footnote) while Trump's falls in the forty-nine to fifty range. 

# Bivariate Analysis 

## Talk aboust some of the relationships you oberseved in this part of the investiations. 
How did the features of interest vary with other features in the dataset. 

the only true correlation I could do on this dataset was amount and zip_code using pearson 
and it found no real true correlation (something closer to zero) or around twenty percent negative correlation. Which means it the price of contributions is pretty all across the board in each zip code. I must stress again that the datasets that were both gathered on the government website are skewed in size, Bernie's being higher, but taking that into account there is a strong notion that Bernie's footnote campaign talk about the average american spending roughly twenty-seven dollars in this contributions seems to be right on the money. However, Sanders did not explain the large amount of refends he was getting from contributors. Trump's, while low, seems to follow a normal uniform pattern in campaign contributions which just shows he's steadly reaching the finish line. 

## Did you obesrve any interesting relationships between teh other features? 

There isn't really any true relationship across the board in this dataset it really just outlines that the Sanders campaign had many contributors who seemed to be up and down along the campaign while Trump's supports were steady and consistent. 


## What is the strongest data point you found? 
the strongerst thing I found was Bernie Sanders footnote of twenty-seven dollars. I though that was pretty wonderful. 




# Multivariate Plots Section and Final Plots


```{r echo=FALSE, message=FALSE, warning=FALSE}

#box plot of payments by canidate. 
ggplot(aes(x = canidate, y = amount, fill = canidate), data = merge_bs_dt_df_subset) +
  geom_boxplot() + labs(title = "Ordered Box Plot", 
                        subtitle = "Amount vs. City", 
                        caption = "source: .gov") + 
  scale_y_continuous(limits = c(0,200), breaks = seq(0,200,10))  

#box plot for both canidates. 
ggplot(aes(x = city, y = amount, fill = city), data = largest_amount_merge) +
  geom_boxplot() + labs(title = "Ordered Box Plot", 
                        subtitle = "Amount vs. City", 
                        caption = "source: .gov") + 
  scale_y_continuous(limits = c(0,200), breaks = seq(0,200,10)) + 
  facet_wrap(~canidate) 




#create map for bernie v trump of contributors. 
head(ca_county)
ggplot(data = ca_county, aes(x = long, y = lat, group = group)) + 
  geom_polygon(fill = I("linen")) + 
  geom_path(aes(color = subregion), linestyle = 1) +
  geom_jitter(data = sample_bernie, aes(x =lon, y = lat, group= NULL), color = "blue", alpha = 1) + 
  geom_jitter(data = sample_trump, aes(x = lon, y = lat, group = NULL), color = "red", alpha = 0.3) + 
  labs(title = "Map of contributors", 
       subtitle = "Trump (red) v. Bernie (blue)", 
       caption= "source: .gov")  + 
       coord_map() 



# heat map for trump and bernie.
set.seed(234190) #set seed
cdf <- merge_bs_dt_df[order(merge_bs_dt_df$canidate), ] #order the dataframe by canidate
cdf <- cdf[sample(1:length(cdf$amount), 50), ] #create a sample of 50 poeple in dataset
cdf <- subset(cdf, select = c("name","canidate","city","zip","employer", 
                              "occupation", "amount","date","lon","lat")) #choose particular columns
row.names(cdf) <- cdf$name #make row into names
cdf_matrix <- data.matrix(cdf) #create the data into a matrix of numberes
cdf_heatmap <- heatmap(cdf_matrix, Rowv=NA, Colv=NA, col = colorRampPalette(c("blue", "red"))(100), scale = "column", margins = c(5,10)) # make heatmap

```
